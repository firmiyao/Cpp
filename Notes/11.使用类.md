<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [运算符重载：](#%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD)
- [计算时间：一个运算符重载示例](#%E8%AE%A1%E7%AE%97%E6%97%B6%E9%97%B4%E4%B8%80%E4%B8%AA%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD%E7%A4%BA%E4%BE%8B)
  - [添加加法运算符：](#%E6%B7%BB%E5%8A%A0%E5%8A%A0%E6%B3%95%E8%BF%90%E7%AE%97%E7%AC%A6)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# 运算符重载：

**运算符重载是一种形式的C++多态**

**C++根据操作数的数目和类型来决定采用哪种操作**，列如，多余两个***int***值，如果用 *，就是乘法运算，但是如果用在指针前就是取值，这是对 *号的重载。

要重载运算符，需使用被称为**运算符函数**的特殊函数形式。格式如下：

```c++
operator 运算符 (参数)
```

运算符必须是有效的C++运算符，不能虚构一个新的符号，例如不能有@这样的符号。

虽然C++对运算符重载做了一些限制，但了解重载的工作方式后，这些限制就很容易理解了。

***

# 计算时间：一个运算符重载示例

假设上午花了2小时35分钟，下午又花费了2小时40分钟，则总共花费了多少时间呢？

问题很简单，现在通过Time类来进行操作，其中设有名为Sum的常规方法，来进行相加操作。

首先列出这个类声明，如下：

创建类：

```c++
#ifndef CLASS_H_
#define CLASS_H_

class Time
{
private:
	int hours;
	int minutes;
public:
	Time();    //默认构造函数
	Time(int h, int m = 0);   //构造函数
	void addmin(int m);
	void addhr(int h);
	void reset(int h = 0, int m = 0);
	Time Sum(const Time& t)const;
	void show() const;
};
#endif
```

定义类方法：

```c++
#include<iostream>
#include"classtime.h"

Time::Time()
{
	hours = minutes = 0;
}

Time::Time(int h, int m)
{
	hours = h;
	minutes = m;
}

void Time::addmin(int m)
{
	minutes += m;
	hours = (minutes / 60);
	minutes %= 60;
}

void Time::addhr(int h)
{
	hours += h;
}

void Time::reset(int h, int m)
{
	hours = h;
	minutes = m;
}

Time Time::Sum(const Time& t) const  //不要返回指向局部变量或者临时对象的引用
{
	Time sum;
	sum.minutes = minutes + t.minutes;
	sum.hours = hours + t.hours + sum.minutes / 60;
	sum.minutes %= 60;
	return sum;
}
void Time::show() const
{
	std::cout << hours << " hours, " << minutes << " minutes" << std::endl;
}
```

运行测试：

```c++
#include<iostream>
#include"classtime.h"

int main(void)
{
	using std::cout;
	using std::endl;
	Time t_1(3, 50);
	Time t_2(4, 30);
	t_1.show();
	t_2.show();
	Time final;
	final = t_1.Sum(t_2);
	final.show();
	return 0;
}
```

![image-20221205124855147](https://cdn.jsdelivr.net/gh/firmiyao/Picture/img/202212051301519.png)

这是常规做法，接下来添加运算符重载：

## 添加加法运算符：

在类定义中添加加法重载：

```c++
#ifndef CLASS_H_
#define CLASS_H_

class Time
{
private:
	int hours;
	int minutes;
public:
	Time();    //默认构造函数
	Time(int h, int m = 0);   //构造函数
	void addmin(int m);
	void addhr(int h);
	void reset(int h = 0, int m = 0);
	//Time Sum(const Time& t)const;
	Time operator+(const Time& t) const;    //添加重载运算符
	void show() const;
};
#endif
```

定义加法重载：

```c++
Time Time::operator+(const Time& t)const
{
	Time sum;
	sum.minutes = minutes + t.minutes;
	sum.hours = hours + t.hours + sum.minutes / 60;
	sum.minutes %= 60;
	return sum;
}
```

测试：

```c++
#include<iostream>
#include"classtime.h"

int main(void)
{
	using std::cout;
	using std::endl;
	Time t_1(3, 50);
	Time t_2(4, 30);
	t_1.show();
	t_2.show();
	Time final;
	//final = t_1 + t_2;
	final=t_1+(t_2);      //二选一效果一致
	final.show();
	return 0;
}
```

![image-20221205130047985](https://cdn.jsdelivr.net/gh/firmiyao/Picture/img/202212051301604.png)

对于多个运算也成立吗？是的，如下：

```c++
#include<iostream>
#include"classtime.h"

int main(void)
{
	using std::cout;
	using std::endl;
	Time t_1(3, 50);
	Time t_2(4, 30);
	Time t_3(2, 50);
	t_1.show();
	t_2.show();
	t_3.show();
	Time final;
	final = t_1 + t_2 + t_3;
	final.show();
	return 0;
}
```



![image-20221205130341583](https://cdn.jsdelivr.net/gh/firmiyao/Picture/img/202212051303627.png)

有如下过程：

```c++
t_1.operator + ( t_2 + t_3 ) ;
t_1.operator + ( t_2.operator + ( t_3 ) ) ;
```

